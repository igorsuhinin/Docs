---
title: Ext JS - Ajax
_old_id: '1330'
_old_uri: 2.x/developing-in-modx/advanced-development/custom-manager-pages/modext/modext-tutorials/2.-ext-js-tutorial-ajax-include
---

## Использование JavaScript для включения другого файла

Ext JS makes it simple to issue Ajax requests to other pages. This example builds on the previous one by implementing a simple Ext JS tool: a pop-up Window. You'll notice that we have once again included the required CSS and JS files in our HTML:

```html
<link  rel="stylesheet" type="text/css" href="manager/assets/ext3/resources/css/ext-all.css" />
<script type="text/javascript" src="manager/assets/ext3/adapter/ext/ext-base.js"></script>
<script type="text/javascript" src="manager/assets/ext3/ext-all.js"></script>
```

### a.html

Мы передали функцию обратного вызова *name* команде `Ext.onReady()`.

Ниже содержимое файла **a.html**:

```html
<html>
   <title>Моя тестовая страница Ext JS</title>
   <link  rel="stylesheet" type="text/css" href="manager/assets/ext3/resources/css/ext-all.css" />
   <script type="text/javascript" src="manager/assets/ext3/adapter/ext/ext-base.js"></script>
   <script type="text/javascript" src="manager/assets/ext3/ext-all.js"></script>
   <script type="text/javascript">
       function buildWindow() {
           var win = new Ext.Window({
               id: 'my_window'
               , title : "Добро пожалователь в Ext JS"
               , width : 300
               , height: 150
               , layout: "fit"
               , autoLoad: {
                   url : "b.html"
                   , scripts : true
               }
           });
           win.show();
       }
       Ext.onReady(buildWindow);
   </script>
   <body>
       <h1>Ввод в Ext JS</h1>
        <p>Я загрузил этот HTML в корень моего сайта и включаю библиотеки Ext JS, которые поставляются вместе с менеджером MODX.</p>
   </body>
</html>
```

**Запятые**
Многие элементы Ext JS, используемые в менеджере MODX и компонентах MODX, ставят запятую первой в строке при добавлении элементов в массив. Это немного облегчает комментирование нежелательных элементов. Мы демонстрируем этот стиль форматирования здесь, чтобы вы могли мысленно подготовиться к тому, что вы увидите в MODX JavaScript.

### b.html

Как вы могли заметить, JavaScript ссылался на файл с именем **b.html**. Давайте создадим его вместе с **a.html** в корне нашего сайта MODX.

Вот что мы поместим в файл **b.html** и сохраним его:

```javascript
<div>Вот моя полезная нагрузка Ajax!</div>
<script type="text/javascript">
   function highlightWindow() {
       var win = Ext.getCmp('my_window');
       var winBody = win.body;
       winBody.highlight();
   }
   highlightWindow.defer(1000);
</script>
```

Теперь, когда вы откроете a.html в браузере, вы должны увидеть всплывающее окно, которое содержит содержимое b.html

![](/download/attachments/46137375/ext_js_window.jpg?version=1&modificationDate=1370296233000)

If everything worked, you should see the window become highlighted in yellow and then fade. Pretty cool, eh?

Что интересно, мы смогли поместить некоторый JavaScript в **b.html** и заставить его контролировать часть своего поведения. Когда вы включаете HTML или текст с помощью JavaScript, не всегда Javascript на странице полезной нагрузки будет включен и выполнен (например, этот маленький трюк немного сложнее сделать с помощью jQuery). Обратите внимание, что Ext JS позволил нам указать сценарии `:true`, когда мы ссылались на **b.html**.

## Обзор методов

### Ext.onReady()

Важно, чтобы почти все, что мы делаем с JavaScript, происходило *после* загрузки страницы (независимо от того, какую платформу вы используете). Вот почему функция `Ext.onReady()` так важна: вы будете использовать эту функцию почти на каждой странице, на которой вы используете Ext JS.

**Вы готовы?**
Почти все, что вы делаете с Ext JS, произойдет *после* загрузки DOM, поэтому вы будете использовать `Ext.onReady()` почти на каждой странице, которую вы создаете с помощью Ext JS, и в значительной степени каждый бит JavaScript, который вы пишете, должен быть включен в этот блок. Это эквивалентно обработчику jQuery:

```javascript
$(function() {
});
```

### Ext.getCmp()

This is how Ext JS can select areas of the DOM. The functionality is quite similar to jQuery, but the syntax is slightly different. We still reference an element by its id, but ExtJS does not use the hash-tag "#" as a selector.

```javascript
<script type="text/javascript">
   var win = Ext.getCmp('my_window');
   // в отличие от селектора jQuery:
   var win = jQuery('#my_window');
</script>
```

В приведенном выше примере интересно то, что Ext JS создал новый id *на лету* в методе `Ext.Window()`, а затем к нему обратился `Ext. .getCmp()`. Видите это? Мы передали "id: 'my_window'" в качестве аргумента `Ext.Window()`. Если вы привыкли искать в HTML атрибуты «id», эта небольшая ловкость рук могла вас смутить, но вы уже можете понять, что Ext JS рисует элементы на экране браузера без необходимости в существующем HTML.

### .delay()

This is a useful method that can be tacked on to just about anything. In our example, we used it to delay the highlighting of the window.

## Various Syntax

Чем больше вы разрабатываете на JavaScript, тем больше вы будете чувствовать себя комфортно с изменяющимся синтаксисом. Иногда проще читать встроенные функции (например, анонимные или лямбда-функции), а в других случаях проще использовать обратный вызов. Приведенный выше код внутри **a.html** можно было бы написать так:

```javascript
   <script type="text/javascript">
       Ext.onReady(function() {
           var win = new Ext.Window({
               id: 'my_window'
               , title : "Добро пожаловать в Ext JS"
               , width : 300
               , height: 150
               , layout: "fit"
               , autoLoad: {
                   url : "b.html"
                   , scripts : true
               }
           });
           win.show();
       });
   </script>
```

Аналогично, код внутри **b.html** можно было бы связать следующим образом:

```javascript
<div>Вот моя полезная нагрузка Ajax!</div>
<script type="text/javascript">
   function highlightWindow() {
       Ext.getCmp('my_window').body.highlight();
   }
   highlightWindow.defer(1000);
</script>
```

Найдите синтаксис, который выглядит удобнее для вас, и когда вы улучшите свои способности в JavaScript, вам станет все более комфортно переключаться между различными синтаксисами, которые он поддерживает.

## Regular Ajax Requests

There are times when you don't want to rely on an Ext panel or window or form to initiate an Ajax request. E.g. maybe you want to trigger this type of action via an onclick event and you don't want to load up jQuery or some other library to do this common task. Take a look at this example which posts some values (myvar) to a remote URL and then decodes the JSON returned.

```javascript
<script type="text/javascript">
   function makeAjaxRequest(var1) {
       Ext.Ajax.request({
           url: 'http://yoursite.com/some/controller',
           params: {
               myvar: var1
           },
           success: function(response, opts){
               // Если ответ возвращается в формате JSON, вы должны декодировать его
               var obj = Ext.decode(response.responseText);
               Ext.fly('some_div').update('Success!');
           },
           failure: function(response, opts) {
               Ext.fly('some_div').update('Fail!');
           },
       callback: function(options,success,response){
       // используйте этот метод, если вам нужно выполнить собственную проверку успеха/неудачи
       }
       });
   }
</script>
```

Документация ExtJS не очень полезна для такого рода вещей, но на самом деле, эти разовые типы очень распространены.

Примечание: обнаружение успеха/неудачи здесь основывается на формате JSON. Это плохо документировано, но ExtJS будет реагировать на JSON-ключ «success», содержащий логическое значение (true/false). Если вы не можете контролировать формат JSON (или не хотите), вы можете реализовать параметр «обратного вызова», который будет вызываться независимо от того, считает ли ExtJS ответ успешным или неудачным.

Also, take a look at the Ext.fly command: this lets you manipulate a div on the fly.

1. [Ext JS - Окна сообщений](extending-modx/custom-manager-pages/modext/modext-tutorials/1.-ext-js-tutorial-message-boxes)
2. [Ext JS - Ajax](extending-modx/custom-manager-pages/modext/modext-tutorials/2.-ext-js-tutorial-ajax-include)
3. [Ext JS - Анимация](extending-modx/custom-manager-pages/modext/modext-tutorials/3.-ext-js-tutorial-animation)
4. [Ext JS - Управление узлами](extending-modx/custom-manager-pages/modext/modext-tutorials/4.-ext-js-tutorial-manipulating-nodes)
5. [Ext JS - Панели](extending-modx/custom-manager-pages/modext/modext-tutorials/5.-ext-js-tutorial-panels)
6. [Ext JS - Расширенная сетка](extending-modx/custom-manager-pages/modext/modext-tutorials/7.-ext-js-tutoral-advanced-grid)
7. [Ext JS - Внутри CMP](extending-modx/custom-manager-pages/modext/modext-tutorials/8.-ext-js-tutorial-inside-a-cmp)
